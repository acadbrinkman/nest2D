from nest2D import Point, Box, Item, nest, SVGWriter, placer_config, Radians
from shapely import wkt
from shapely.geometry import LineString, MultiLineString, Polygon, MultiPolygon
from shapely.affinity import rotate, translate
from math import pi

product1_wkt = """POLYGON ((-1845.456027102935 -3261.74, -1846.610433797675 -3261.74, -1866.666350049767 -3281.018555045037, 
    -1866.673685554837 -3281.024949459809, -1866.681607849542 -3281.030600603191, -1866.690041911195 -3281.035454959886, 
    -1866.698907870773 -3281.039466560024, -1866.708121769257 -3281.042597414483, -1866.717596352709 -3281.044817874643, 
    -1866.727241898553 -3281.046106913151, -1866.736967065231 -3281.046452323047, -1866.746679757188 -3281.045850833364, 
    -1866.756287997006 -3281.044308140098, -1866.765700796406 -3281.041838852273, -1866.774829017896 -3281.038466353595, 
    -1866.783586218885 -3281.03422258101, -1866.791889470277 -3281.029147722271, -1866.799660141797 -3281.023289835362, 
    -1866.806824646604 -3281.016704393405, -1866.813315138145 -3281.009453759332, -1866.819070152651 -3281.001606595325, 
    -1866.824035191182 -3280.993237212595, -1866.828163235732 -3280.984424867668, -1866.831415194472 -3280.975253011844, 
    -1866.833760271945 -3280.965808500922, -1866.835176260696 -3280.956180772698, -1866.835649751571 -3280.946461, 
    -1866.835649751571 -1642.989621, -1866.835158237188 -1642.979718409929, -1866.833688525769 -1642.969913165166, 
    -1866.831255064997 -1642.960301654089, -1866.827881776494 -1642.950978360616, -1866.823601820656 -1642.942034935404, 
    -1866.818457270678 -1642.933559294895, -1866.812498698969 -1642.925634757073, -1866.80578468 -1642.918339222425, -1866.798381214511
    -1642.911744408155, -1866.790361080696 -1642.905915143184, -1866.781803118778 -1642.900908730863, -1866.772791455985 -1642.896774385667, 
    -1866.763414679554 -1642.893552749396, -1866.753764965893 -1642.891275491663, -1866.743937174465 -1642.889964998566, -1866.734027915286 
    -1642.889634152629, -1866.724134599225 -1642.890286206164, -1866.714354480423 -1642.891914749295, -1866.704783700262 -1642.894503772977,
    -1866.695516342264 -1642.89802782636, -1866.686643507224 -1642.902452266987, -1866.678252417663 -1642.907733601334, -1866.670425560405 
    -1642.913819912365, -1844.221891766207 -1662.23, -1842.995353504197 -1662.23, -1866.034287230681 -1642.405801087175, -1866.041338543428 
    -1642.399110429436, -1866.047706954476 -1642.391766775499, -1866.053332291312 -1642.383839512547, -1866.05816140243 -1642.375403542049, 
    -1866.06214865953 -1642.366538572041, -1866.065256388651 -1642.357328364002, -1866.067455226131 -1642.347859941421, -1866.068724396054 
    -1642.338222767554, -1866.06905190655 -1642.328507900118, -1866.068434663108 -1642.318807130924, -1866.066878497809 -1642.309212118575, 
    -1866.064398114221 -1642.299813522419, -1866.061016948477 -1642.290700145952, -1866.056766947829 -1642.281958097741, -1866.051688268795 
    -1642.273669977828, -1866.045828897739 -1642.265914097268, -1866.039244197462 -1642.258763738208, -1866.031996384106 -1642.252286461467, 
    -1866.024153939296 -1642.246543468186, -1866.015790963088 -1642.24158902156, -1866.006986473825 -1642.237469934132, -1865.997823661527 
    -1642.234225125473, -1865.988389101864 -1642.231885254455, -1865.978771938132 -1642.230472429562, -1865.96906303898 -1642.23, -375.9956496524544 
    -1642.23, -375.9858479384214 -1642.230481527333, -375.9761406202528 -1642.23192147196, -375.966621184729 -1642.234305966427, -375.9573813092179 
    -1642.237612046749, -375.9485099787718 -1642.241807873565, -375.9400926291524 -1642.24685303877, -375.9322103240381 -1642.252698954664, 
    -375.9249389743358 -1642.259289321881, -375.9183486071181 -1642.266560671584, -375.9125026912242 -1642.274442976698, -375.9074575260196 -1642.282860326317, 
    -375.9032616992033 -1642.291731656763, -375.8999556188812 -1642.300971532274, -375.8975711244141 -1642.310490967798, -375.8961311797872 -1642.320198285967, 
    -375.8956496524544 -1642.33, -375.8956496524544 -1662.23, -375.095649642392 -1662.23, -375.095649642392 -1642.33, -375.0951681150592 -1642.320198285967, 
    -375.0937281704323 -1642.310490967798, -375.0913436759652 -1642.300971532274, -375.0880375956431 -1642.291731656763, -375.0838417688268 -1642.282860326317, 
    -375.0787966036222 -1642.274442976698, -375.0729506877283 -1642.266560671584, -375.0663603205106 -1642.259289321881, -375.0590889708083 -1642.252698954664, 
    -375.0512066656939 -1642.24685303877, -375.0427893160746 -1642.241807873565, -375.0339179856285 -1642.237612046749, -375.0246781101174 -1642.234305966427, 
    -375.0151586745936 -1642.23192147196, -375.0054513564249 -1642.230481527333, -374.995649642392 -1642.23, 1114.09635628254 -1642.23, 1114.106275315095 -1642.230493152029,
    1114.116096515829 -1642.231967744136, 1114.125723017841 -1642.234409232361, 1114.135059874552 -1642.237793536206, 1114.144014996164 -1642.242087276145, 1114.15250005795 
    -1642.247248102845, 1114.160431371401 -1642.253225114865, 1114.167730709651 -1642.259959360693, 1114.17432607903 -1642.267384420187, 1114.180152429143 -1642.275427059686, 
    1114.185152294462 -1642.28400795431, 1114.189276361112 -1642.293042470346, 1114.192483953258 -1642.302441499997, 1114.194743434286 -1642.312112340252, 1114.196032518845 
    -1642.32195960722, 1114.196338492641 -1642.331886176909, 1114.195658337842 -1642.341794143158, 1114.193998762842 -1642.351585783295, 1114.191376136097 -1642.361164521975,
    1114.187816324682 -1642.370435883711, 1114.183354439159 -1642.379308424684, 1114.178034487288 -1642.387694634665, 1114.17190893997 -1642.395511800123, 1114.165038213725 
    -1642.402682820038, 1093.182731782384 -1662.23, 1094.347520454929 -1662.23, 1114.755667425087 -1642.945237179955, 1114.763029140153 -1642.938927398473, 1114.770967315477
    -1642.93336021215, 1114.77940732571 -1642.928587957095, 1114.788269827842 -1642.924655496416, 1114.797471507095 -1642.921599798464, 1114.806925860145 -1642.919449589302,
    1114.816544008331 -1642.918225082659, 1114.826235533181 -1642.917937789899, 1114.835909326423 -1642.91859041181, 1114.845474446476 -1642.920176813211, 1114.854840973378
    -1642.92268208063, 1114.863920854103 -1642.926082662501, 1114.872628730335 -1642.930346590569, 1114.880882740905 -1642.935433780417, 1114.888605291353 -1642.941296408294,
    1114.895723783379 -1642.947879360695, 1114.902171297326 -1642.955120752477, 1114.907887221284 -1642.962952508625, 1114.912817820884 -1642.971301004215,
    1114.916916744452 -1642.980087756552, 1114.920145458748 -1642.989230162965, 1114.922473611214 -1642.998642277347, 1114.92387931531 -1643.008235618113, 1114.924349356265 
    -1643.01792, 1114.924349356265 -3280.829721, 1114.923859082588 -3280.839611114617, 1114.922393068922 -3280.849404251976, 1114.919965690226 -3280.859004385729,
    1114.916600748098 -3280.868317382018, 1114.912331237387 -3280.877251922505, 1114.90719902267 -3280.885720399788, 1114.90125442774 -3280.893639776439, 1114.894555742167
    -3280.900932399218, 1114.887168649735 -3280.907526760507, 1114.879165584382 -3280.913358199469, 1114.870625019955 -3280.918369536085, 1114.861630700732 -3280.922511631826, 
    1114.852270820273 -3280.925743871482, 1114.842637156637 -3280.928034561412, 1114.832824172458 -3280.929361240318, 1114.822928088694 -3280.929710899482, 1114.81304594113 
    -3280.929080110334, 1114.803274628905 -3280.927475058058, 1114.793709964362 -3280.924911480952, 1114.784445733565 -3280.921414516104, 1114.775572776684 -3280.917018452909, 
    1114.767178097264 -3280.91176639685, 1114.759344009112 -3280.905709846823, 1114.752147329171 -3280.89890819017, 1114.745658624296 -3280.891428120353, 1094.924349602233 
    -3255.614712781829, 1094.924349602233 -3256.911159398289, 1114.267641247741 -3281.578292879552, 1114.273258798503 -3281.58622162632, 1114.278080294425 -3281.594658158721, 
    1114.282060210027 -3281.60352281741, 1114.285160966188 -3281.612731900595, 1114.287353284979 -3281.62219845436, 1114.288616466109 -3281.631833093705, 1114.288938582381 
    -3281.641544846533, 1114.288316592312 -3281.651242012626, 1114.286756368852 -3281.660833029497, 1114.284272643926 -3281.670227336941, 1114.280888869337 -3281.679336232122, 
    1114.276636995329 -3281.688073707117, 1114.271557168905 -3281.696357261027, 1114.265697354752 -3281.70410867896, 1114.25911288235 -3281.711254770553, 1114.25186592354 
    -3281.717728061052, 1114.244024905484 -3281.723467428414, 1114.235663864567 -3281.728418680443, 1114.226861747327 -3281.732535066476, 1114.217701665029 -3281.735777718811, 
    1114.208270108912 -3281.73811601971, 1114.198656133524 -3281.739527890491, 1114.188950515847 -3281.74, -322.9956495663662 -3281.74, -323.0054512803991 -3281.739518472667, 
    -323.0151585985678 -3281.73807852804, -323.0246780340916 -3281.735694033573, -323.0339179096027 -3281.732387953251, -323.0427892400488 -3281.728192126435, -323.0512065896681 
    -3281.72314696123, -323.0590888947825 -3281.717301045336, -323.0663602444848 -3281.710710678119, -323.0729506117025 -3281.703439328416, -323.0787965275964 -3281.695557023302, 
    -323.083841692801 -3281.687139673682, -323.0880375196173 -3281.678268343237, -323.0913435999394 -3281.669028467725, -323.0937280944065 -3281.659509032202, -323.0951680390334 
    -3281.649801714033, -323.0956495663662 -3281.64, -323.0956495663662 -3261.74, -323.8956495764284 -3261.74, -323.8956495764284 -3281.64, -323.8961311037611 -3281.649801714033, 
    -323.897571048388 -3281.659509032202, -323.8999555428551 -3281.669028467725, -323.9032616231772 -3281.678268343237, -323.9074574499936 -3281.687139673682, -323.9125026151982 
    -3281.695557023302, -323.9183485310921 -3281.703439328416, -323.9249388983097 -3281.710710678119, -323.932210248012 -3281.717301045336, -323.9400925531264 -3281.72314696123, 
    -323.9485099027458 -3281.728192126435, -323.9573812331919 -3281.732387953251, -323.966621108703 -3281.735694033573, -323.9761405442268 -3281.73807852804, -323.9858478623954 
    -3281.739518472667, -323.9956495764284 -3281.74, -434.9956502461299 -3281.74, -435.0054519601629 -3281.739518472667, -435.0151592783315 -3281.73807852804, -435.0246787138553 
    -3281.735694033573, -435.0339185893664 -3281.732387953251, -435.0427899198125 -3281.728192126435, -435.0512072694319 -3281.72314696123, -435.0590895745462 -3281.717301045336, 
    -435.0663609242486 -3281.710710678119, -435.0729512914662 -3281.703439328416, -435.0787972073601 -3281.695557023302, -435.0838423725647 -3281.687139673682, -435.0880381993811 
    -3281.678268343237, -435.0913442797032 -3281.669028467725, -435.0937287741702 -3281.659509032202, -435.0951687187971 -3281.649801714033, -435.0956502461299 -3281.64, 
    -435.0956502461299 -3261.74, -435.8956502561926 -3261.74, -435.8956502561926 -3281.64, -435.8961317835254 -3281.649801714033, -435.8975717281523 -3281.659509032202, 
    -435.8999562226194 -3281.669028467725, -435.9032623029415 -3281.678268343237, -435.9074581297578 -3281.687139673682, -435.9125032949624 -3281.695557023302, 
    -435.9183492108563 -3281.703439328416, -435.924939578074 -3281.710710678119, -435.9322109277763 -3281.717301045336, -435.9400932328907 -3281.72314696123, 
    -435.94851058251 -3281.728192126435, -435.9573819129561 -3281.732387953251, -435.9666217884672 -3281.735694033573, -435.976141223991 -3281.73807852804, 
    -435.9858485421597 -3281.739518472667, -435.9956502561926 -3281.74, -1866.014145747116 -3281.74, -1866.024029395833 -3281.739510368746, -1866.033816257683 
    -3281.738046269761, -1866.043410493599 -3281.735622040416, -1866.052718150825 -3281.73226142028, -1866.061648082963 -3281.727997318647, -1866.070112842536 
    -3281.722871492265, -1866.078029537327 -3281.716934136431, -1866.085320642112 -3281.710243393442, -1866.091914757836 -3281.702864783239, -1866.097747310796 
    -3281.694870561782, -1866.102761184987 -3281.686339013486, -1866.10690728142 -3281.677353684606, -1866.110144998926 -3281.668002565097, -1866.112442631751 
    -3281.658377226966, -1866.11377768004 -3281.648571927542, -1866.114137070164 -3281.638682686446, -1866.113517282752 -3281.628806345308, -1866.111924387148 
    -3281.619039619432, -1866.109373981982 -3281.609478150706, -1866.105891042415 -3281.600215571006, -1866.10150967557 -3281.591342585302, -1866.096272786529 
    -3281.582946083418, -1866.090231658182 -3281.575108289148, -1866.083445449035 -3281.567905955073, -1845.456027102935 -3261.74), 
    (-218.0967392478793 -3142.54, 1005.188950760697 -3142.54, 1005.198998008358 -3142.54050601619, 1005.20894357462 -3142.542018943711, 1005.218686807131 
    -3142.544523471248, 1005.228129101224 -3142.547994252171, 1005.237174897825 -3142.552396161053, 1005.245732650544 -3142.55768464915, 1005.253715752151 
    -3142.563806195252, 1005.261043411075 -3142.570698847329, 1005.267641469033 -3142.57829284951, 1005.509587154694 -3142.88682884951, 1020.921066628455 -3162.54, 
    1021.937704799666 -3162.54, 1006.139112471117 -3142.393171120353, 1005.745658904227 -3141.891428165088, 1005.740160239416 -3141.883685352832, 1005.735420848625 
    -3141.875455855202, 1005.731483474738 -3141.866813891119, 1005.728383627537 -3141.857837399396, 1005.726149263444 -3141.848607335831, 1005.724800533398 -3141.839206943095, 
    1005.724349601116 -3141.829721, 1005.724349601116 -1774.429145005456, 1004.924349591053 -1775.323465840205, 1004.924349591053 -1805.283283, 1004.923806625256 
    -1805.293689649194, 1004.922183624104 -1805.303983289296, 1004.919498212278 -1805.314052138416, 1004.915779551515 -1805.323786855742, 1004.911068023925 
    -1805.333081728902, 1004.905414793475 -1805.341835821932, 1004.898881250382 -1805.34995407137, -190.5170649090558 -3141.70667107137, -190.5236111290554 -3141.713334712375, 
    -190.5307505703354 -3141.719358455891, -190.5384209361961 -3141.724689740473, -190.5465552972434 -3141.729282046874, -190.5550826753955 -3141.733095303956, -190.5639286632171 
    -3141.736096238343, -190.5730160731769 -3141.738258664747, -190.5822656111638 -3141.739563714461, -190.5915965683847 -3141.74, -217.3811123909582 -3141.74, -218.0967392478793 
    -3142.54), (-343.8956497776747 -1725.43, -343.8956497776747 -1725.99568542687, -324.278492551103 -1745.612842321283, -323.9249388635292 -1745.966396356662, -323.9183485037886 
    -1745.973667704853, -323.912502594703 -1745.981550007371, -323.9074574355019 -1745.989967353429, -323.9032616137657 -1745.998838679485, -323.8999555375008 -1746.008078549926, 
    -323.8975710459891 -1746.017597979859, -323.8961311031585 -1746.027305292086, -323.8956495764284 -1746.037107, -323.8956495764284 -3162.54, -323.0956495663662 -3162.54, 
    -323.0956495663662 -3142.64, -323.0951680390334 -3142.630198285967, -323.0937280944065 -3142.620490967798, -323.0913435999394 -3142.610971532275, -323.0880375196173 
    -3142.601731656763, -323.083841692801 -3142.592860326317, -323.0787965275964 -3142.584442976698, -323.0729506117025 -3142.576560671584, -323.0663602444848 -3142.569289321881, 
    -323.0590888947825 -3142.562698954664, -323.0512065896681 -3142.55685303877, -323.0427892400488 -3142.551807873565, -323.0339179096027 -3142.547612046749, -323.0246780340916 
    -3142.544305966427, -323.0151585985678 -3142.54192147196, -323.0054512803991 -3142.540481527333, -322.9956495663662 -3142.54, -272.0335506741176 -3142.54, -271.3179238170972 
    -3141.74, -297.9285328400367 -3141.74, -297.9385187041643 -3141.739500163405, -297.9484047422854 -3141.738005650353, -297.9580921263274 -3141.735531401089, -297.9674840141092 
    -3141.73210215002, -297.9764865174466 -3141.727752178451, -297.9850096407273 -3141.722524971879, -297.992968180573 -3141.71647278529, -298.0002825775945 -3141.709656120767, 
    -298.0068797117258 -3141.702143122681, -298.0126936331856 -3141.694008896457, -298.0176662217598 -3141.685334757776, -298.0217477678137 -3141.676207419675, -298.0248974692256 
    -3141.666718125707, -298.0270838392748 -3141.6569617378, -298.0282850214062 -3141.647035787947, -298.0284890077241 -3141.637039503208, -298.0276937590319 -3141.627072813762, 
    -298.0259072252176 -3141.61723535393, -298.0231472657807 -3141.607625466163, -298.0194414712958 -3141.598339217931, -298.0148268875969 -3141.589469441368, -298.00934964544 
    -3141.581104805252, -298.0030644993465 -3141.573328928608, 950.1485731446767 -1746.263328928608, 950.1551193646759 -1746.256665287607, 950.1622588059549 -1746.250641544095, 
    950.1699291718141 -1746.245310259517, 950.1780635328595 -1746.240717953119, 950.1865909110093 -1746.236904696039, 950.1954368988281 -1746.233903761654, 950.2045243087849 
    -1746.231741335252, 950.2137738467687 -1746.230436285538, 950.2231048039864 -1746.23, 977.0126202334264 -1746.23, 977.7282470904469 -1745.43, -323.2885431664669 -1745.43, 
    -323.2983448690261 -1745.429518473797, -323.308052176053 -1745.428078532539, -323.3175716010938 -1745.425694043613, -323.3268114670967 -1745.422387970899, -323.3356827893099 
    -1745.418192153609, -323.3441001322514 -1745.413146999662, -323.3519824324974 -1745.407301096535, -323.3592537793661 -1745.400710743338, -323.7128074315603 -1745.047157743338, 
    -343.3299647255615 -1725.43, -343.8956497776747 -1725.43), (-1729.109923831647 -1753.43, -1729.059373954883 -1753.486528533302, -1728.394534645887 -1754.23, -1701.608989598415 
    -1754.23, -1701.599656815241 -1754.230436456681, -1701.590405499178 -1754.231742016835, -1701.581316406201 -1754.233905284054, -1701.572468876216 -1754.236907374889, 
    -1701.563940140495 -1754.240722083687, -1701.555804647512 -1754.245316111346, -1701.548133413072 -1754.250649355985, -1701.540993400406 -1754.256675262999, -1701.534446935638 
    -1754.263341231439, -447.5376851131385 -3156.573341231439, -447.531401673148 -3156.581117565341, -447.525926114198 -3156.589482446766, -447.5213131661358 -3156.598352266226, 
    -447.5176089367551 -3156.607638367225, -447.5148504509352 -3156.61724793241, -447.5130652805658 -3156.627084911308, -447.512271268958 -3156.637050980374, -447.5124763524949 
    -3156.647046525773, -447.5136784813054 -3156.656971639041, -447.5158656397529 -3156.666727115708, -447.5190159665354 -3156.67621544687, -447.5230979731958 -3156.685341793823, 
    -447.528070858858 -3156.694014936002, -447.5338849180445 -3156.702148182761, -447.540482037497 -3156.70966023987, -447.547796277036 -3156.716476022073, -447.5557545286525 
    -3156.722527403591, -447.5642772472443 -3156.727753899059, -447.5732792456933 -3156.732103268093, -447.5826705463361 -3156.735532037451, -447.5923572803175 -3156.738005935558, 
    -447.6022426258379 -3156.739500235064, -447.612227775916 -3156.74, -474.2189257489273 -3156.74, -473.5035365629871 -3157.54, -435.9956502561926 -3157.54, -435.9858485421597 
    -3157.540481527333, -435.976141223991 -3157.54192147196, -435.9666217884672 -3157.544305966427, -435.9573819129561 -3157.547612046749, -435.94851058251 -3157.551807873565, 
    -435.9400932328907 -3157.55685303877, -435.9322109277763 -3157.562698954664, -435.924939578074 -3157.569289321881, -435.9183492108563 -3157.576560671584, -435.9125032949624 
    -3157.584442976698, -435.9074581297578 -3157.592860326317, -435.9032623029415 -3157.601731656763, -435.8999562226194 -3157.610971532275, -435.8975717281523 -3157.620490967798, 
    -435.8961317835254 -3157.630198285967, -435.8956502561926 -3157.64, -435.8956502561926 -3177.54, -435.0956502461299 -3177.54, -435.0956502461299 -1754.037107, -435.0951687193998 
    -1754.027305292086, -435.0937287765692 -1754.017597979859, -435.0913442850575 -1754.008078549926, -435.0880382087926 -1753.998838679485, -435.0838423870564 -1753.989967353429, 
    -435.0787972278553 -1753.981550007371, -435.0729513187696 -1753.973667704853, -435.0663609590291 -1753.966396356662, -434.7128073068349 -1753.612842356662, -415.0956500448842 
    -1733.995685260314, -415.0956500448842 -1733.43, -415.6613348620169 -1733.43, -435.2784923253923 -1753.047157677732, -435.6320460431926 -1753.400710743338, -435.6393173900613 
    -1753.407301096535, -435.6471996903074 -1753.413146999662, -435.6556170332489 -1753.418192153609, -435.664488355462 -1753.422387970899, -435.6737282214649 -1753.425694043613, 
    -435.6832476465057 -1753.428078532539, -435.6929549535326 -1753.429518473797, -435.7027566560918 -1753.43, -1729.109923831647 -1753.43), (-1757.635649549207 -3177.323513270647, 
    -1737.458450192155 -3157.928375955073, -1737.083445039172 -3157.567905949062, -1737.07623869647 -3157.561613677738, -1737.068464050231 -3157.556038829809, -1737.06019225717 
    -3157.551232428545, -1737.051499024089 -3157.547238464077, -1737.042463914983 -3157.544093490787, -1737.033169622831 -3157.541826292745, -1737.023701212763 -3157.540457620268, 
    -1737.014145343506 -3157.54, -527.4323859391003 -3157.54, -528.1477751251953 -3156.74, -554.9333201643063 -3156.74, -554.9426529474796 -3156.739563543319, -554.9519042635416 
    -3156.738257983165, -554.960993356518 -3156.736094715946, -554.969840886502 -3156.733092625112, -554.9783696222221 -3156.729277916314, -554.9865051152045 -3156.724683888656, 
    -554.994176349644 -3156.719350644019, -555.0013163623101 -3156.713324737006, -555.0078628270784 -3156.706658768567, -1736.810192447884 -1835.129701768567, -1736.816723270574 
    -1835.121584352521, -1736.822374088508 -1835.112831504703, -1736.827083565397 -1835.103538232099, -1736.830800582655 -1835.09380540769, -1736.833484794256 -1835.083738675532, 
    -1736.835107064671 -1835.073447304051, -1736.835649785112 -1835.063043, -1736.835649785112 -1805.09767925669, -1737.635649347961 -1804.203061805491, -1737.635649347961 
    -3156.946461, -1737.6361553888 -3156.956508491746, -1737.637668389769 -3156.966454294669, -1737.640173038063 -3156.97619774912, -1737.643643984595 -3156.985640243382, 
    -1737.648046100553 -3156.9946862117, -1737.653334832925 -3157.003244101487, -1737.659456655423 -3157.011227299908, -1737.6663496102 -3157.018555010474, -1738.012848467925 
    -3157.351624010474, -1757.635649549207 -3176.213851296842, -1757.635649549207 -3177.323513270647))
    """

product2_wkt = """
    POLYGON ((-1377.360508362363 -2104.465452368309, -1377.37016530347 -2104.464984993555, -1377.379731976367 -2104.463587238078, -1377.389118956627 -2104.461272167389, 
    -1377.398238499499 -2104.458061421601, -1377.4070053601 -2104.453985013144, -1377.415337590243 -2104.449081046225, -1377.423157304449 -2104.443395360653, -1377.430391407978 
    -2104.436981103343, -1377.436972280083 -2104.429898231535, -1377.442838406093 -2104.422212952338, -1377.447934952426 -2104.413997103862, -1377.452214279139 -2104.40532748371, 
    -1377.455636385247 -2104.396285131113, -1377.45816928263 -2104.386954569418, -1377.459789295043 -2104.377423016004, -1377.460481279426 -2104.36777956702, -1377.46023876746 
    -2104.358114364557, -1377.459064026025 -2104.348517754048, -1377.456968036009 -2104.339079439762, -1377.453970389669 -2104.329887646296, -1377.450099107489 -2104.321028293894, 
    -1377.445390376262 -2104.312584195308, -1306.44128230089 -1990.312584831336, -1306.435496179404 -1990.304266079236, -1306.428897894665 -1990.296575599612, -1306.421555198412 
    -1990.289592358955, -1306.413543486066 -1990.283388061764, -1306.404945022561 -1990.278026414283, -1306.395848097643 -1990.273562470359, -1306.386346119297 -1990.270042066141, 
    -1306.376536654634 -1990.267501349434, -1306.366520428061 -1990.265966408533, -1306.356400287031 -1990.265453004337, 23.41549770781426 -1990.265452479418, 23.42476848872616 
    -1990.265883143667, 23.43395941775985 -1990.267171426985, 23.44299133082378 -1990.269306233022, 23.45178643347625 -1990.272269174086, 23.46026897099115 -1990.276034729519, 
    23.46836588085502 -1990.280570465519, 206.5000279507606 -2104.28057035441, 206.5081908171394 -2104.286236131134, 206.515751103234 -2104.292684036807, 206.5226341637592 
    -2104.299850409055, 206.5287720399091 -2104.30766449184, 206.5341041303372 -2104.316049134055, 206.5385777894948 -2104.324921551264, 206.5421488474179 -2104.334194143065, 
    206.5447820458327 -2104.343775357994, 206.5464513862724 -2104.353570597444, 206.5471403867691 -2104.363483149674, 206.5468422445857 -2104.373415144672, 206.5455599033817 
    -2104.383268520461, 206.5433060241496 -2104.392945991298, 206.5401028602083 -2104.402352008211, 206.5359820374888 -2104.411393702384, 206.5309842422804 -2104.419981802083, 
    206.5251588195212 -2104.42803151407, 206.5185632855985 -2104.43546336079, 206.51126276047 -2104.442203965084, 206.5033293247123 -2104.448186774665, 206.4948413078447 
    -2104.453352719211, 206.4858825149549 -2104.457650793589, 206.4765413992632 -2104.461038561443, 206.4669101887932 -2104.463482574185, 206.4570839757735 -2104.464958701242, 
    206.4471597777593 -2104.465452368309, -1377.360508362363 -2104.465452368309))
    """

product3_wkt = """
    POLYGON ((-1198.34071655893 0.02728539866782661, -1198.336900769181 0.01842926454031078, -1198.333955742917 0.009246771230234273, -1198.331908866337 -0.0001766920054664042, 
    -1198.330779173626 -0.009753495097661361, -1198.33057716995 -0.01939458204899359, -1198.331304733769 -0.02901029907773753, -1198.332955099369 -0.0385112283205359, 
    -1198.335512919773 -0.0478090193412995, -1198.338954409463 -0.05681721071395537, -1198.343247565555 -0.06545203403903331, -1198.348352465407 -0.07363319291743088, 
    -1198.354221637858 -0.08128460963757379, -1198.360800504674 -0.0883351326324259, -1198.368027888076 -0.09471919812760962, -1198.375836579641 -0.1003774398278808, 
    -1198.384153965281 -0.1052572409724005, -1198.392902700492 -0.1093132236251659, -1198.402001429595 -0.1125076706506227, -1198.411365542267 -0.1148108764504499, 
    -1198.420907960348 -0.1162014231999676, -1198.430539947591 -0.1166663800154083, -1243.031917947591 -0.1166663800152946, -1243.041342124874 -0.1162213140092539, 
    -1243.050682414538 -0.1148900776661264, -1243.059855675674 -0.1126845207467586, -1243.06878025415 -0.1096242756193347, -1243.077376709435 -0.1057365825053819, 
    -1243.085568521728 -0.1010560470058391, -1243.093282773086 -0.09562433206556691, -2830.564112773086 1233.660671667934, -2830.571770282725 1233.667269981699, 
    -2830.578722555285 1233.674607631505, -2830.584898555783 1233.682609644768, -2830.590235180812 1233.691194260758, -2830.5946779033 1233.700273765994, -2830.598181329642 
    1233.709755390448, -2830.600709663508 1233.719542255435, -2830.602237071599 1233.729534363467, -2830.602747947591 1233.739629619984, -2830.602747947591 1328.062216619984, 
    -2830.602247768771 1328.072205893494, -2830.600752235886 1328.082095238544, -2830.598276309614 1328.091785726314, -2830.594844758074 1328.101180417269, -2830.590491909053 
    1328.110185330901, -2830.585261306609 1328.118710385867, -2830.579205275472 1328.12667030113, -2830.572384397614 1328.133985449069, -2830.564866906207 1328.140582652042, 
    -2830.556728003051 1328.146395914425, -2830.548049106285 1328.151367082804, -2830.538917035917 1328.155446427716, -2830.52942314531 1328.158593141122, -2830.519662407325 
    1328.160775744635, -2830.509732464249 1328.161972404413, -2830.499732651027 1328.162171149579, -2830.489763001554 1328.161369991971, -2830.479923247981 1328.15957694603, 
    -2830.470311823035 1328.156809948627, -2810.602747947592 1321.344207139021, -2810.602747947592 1322.189932402297, -2830.535184073573 1329.02478029183, -2830.54404892452 
    1329.028300960504, -2830.552538016328 1329.032650214521, -2830.560574114655 1329.037788484066, -2830.568084106521 1329.043669020809, -2830.574999665505 1329.050238323221, 
    -2830.581257873372 1329.057436623335, -2830.586801792515 1329.065198430519, -2830.591580983975 1329.073453127316, -2830.595551966338 1329.082125611925, -2830.598678611334 
    1329.091136981483, -2830.60093247253 1329.100405249927, -2830.60229304414 1329.10984609391, -2830.602747947591 1329.119373619984, -2830.60274794759 1383.483333619984, 
    -2830.602266420257 1383.493135334017, -2830.60082647563 1383.502842652186, -2830.598441981163 1383.51236208771, -2830.595135900841 1383.521601963221, -2830.590940074025 
    1383.530473293667, -2830.58589490882 1383.538890643286, -2830.580048992926 1383.5467729484, -2830.573458625709 1383.554044298103, -2830.566187276006 1383.56063466532, 
    -2830.558304970892 1383.566480581214, -2830.549887621272 1383.571525746419, -2830.541016290827 1383.575721573235, -2830.531776415315 1383.579027653557, -2830.522256979792 
    1383.581412148024, -2830.512549661623 1383.582852092651, -2830.50274794759 1383.583333619984, -1190.869854947591 1383.583333619985, -1190.860053233558 1383.582852092652, 
    -1190.850345915389 1383.581412148025, -1190.840826479865 1383.579027653558, -1190.831586604354 1383.575721573236, -1190.822715273908 1383.57152574642, -1190.814297924289 
    1383.566480581215, -1190.806415619175 1383.560634665321, -1190.799144269472 1383.554044298104, -1190.792553902255 1383.546772948401, -1190.786707986361 1383.538890643287, 
    -1190.781662821156 1383.530473293667, -1190.77746699434 1383.521601963221, -1190.774160914018 1383.51236208771, -1190.771776419551 1383.502842652186, -1190.770336474924 
    1383.493135334018, -1190.769854947591 1383.483333619985, -1190.770336474924 1383.473531905952, -1190.771776419551 1383.463824587783, -1190.774160914018 1383.454305152259, 
    -1190.77746699434 1383.445065276748, -1190.781662821156 1383.436193946302, -1190.786707986361 1383.427776596683, -1190.792553902255 1383.419894291569, -1190.799144269472 
    1383.412622941866, -1210.628433591354 1363.583333619984, -1210.162747947591 1363.583333619984, -1210.152946233558 1363.582852092651, -1210.143238915389 1363.581412148024, 
    -1210.133719479865 1363.579027653557, -1210.124479604355 1363.575721573235, -1210.115608273908 1363.571525746419, -1210.107190924289 1363.566480581214, -1210.099308619175 
    1363.56063466532, -1210.092037269472 1363.554044298103, -1210.085446902255 1363.5467729484, -1210.079600986361 1363.538890643286, -1210.074555821156 1363.530473293667, 
    -1210.07035999434 1363.521601963221, -1210.067053914018 1363.51236208771, -1210.064669419551 1363.502842652186, -1210.063229474924 1363.493135334017, -1210.062747947591 
    1363.483333619984, -1210.062747947591 1363.017648928362, -1206.165619626144 1366.914777297668, -1190.233458623491 1382.846937300323, -1190.226187273683 1382.853527667229, 
    -1190.218304968501 1382.859373582814, -1190.209887618852 1382.864418747714, -1190.201016288411 1382.868614574237, -1190.191776412939 1382.871920654279, -1190.182256977484 
    1382.874305148484, -1190.172549659412 1382.87574509287, -1190.162747945499 1382.876226619985, -1190.152946231606 1382.87574509246, -1190.143238913594 1382.874305147668, 
    -1190.133719478239 1382.871920653065, -1190.124479602905 1382.868614572636, -1190.11560827264 1382.864418745742, -1190.107190923202 1382.859373580489, -1190.099308618265 
    1382.853527664575, -1190.092037268733 1382.846937297364, -1190.085446901674 1382.839665947694, -1190.079600985925 1382.831783642635, -1190.074555820848 1382.823366293091, 
    -1190.07035999414 1382.814494962738, -1190.067053913904 1382.805255087335, -1190.0646694195 1382.79573565193, -1190.063229474911 1382.786028333888, -1190.062747947591 
    1382.776226619985, -1190.062747947591 -0.01666638001529464, -1190.063229474924 -0.0264680940482507, -1190.064669419551 -0.03617541221690747, -1190.067053914018 
    -0.04569484774074087, -1190.07035999434 -0.05493472325180362, -1190.074555821156 -0.06380605369789441, -1190.079600986361 -0.07222340331725485, -1190.085446902255 
    -0.08010570843165919, -1190.092037269472 -0.08737705813394939, -1190.099308619175 -0.09396742535156834, -1190.107190924289 -0.09981334124554916, -1190.115608273908 
    -0.1048585064501301, -1190.124479604355 -0.1090543332664233, -1190.133719479865 -0.1123604135885155, -1190.143238915389 -0.1147449080556177, -1190.152946233558 
    -0.1161848526825143, -1190.162747947591 -0.1166663800152946, -1197.317243947591 -0.1166663800154083, -1197.327369605927 -0.1161524144286214, -1197.337391179464 
    -0.1146158008807488, -1197.347205653324 -0.1120723347014663, -1197.356712141471 -0.1085481609725201, -1197.365812923749 -0.104079505774281, -1197.374414450381 
    -0.09871230380657126, -1197.382428303592 -0.09250172621156549, -1197.389772106488 -0.08551161345242184, -1197.396370369829 -0.07781381907725946, -1197.402155268009 
    -0.06948747111413825, -1197.407067336257 -0.06061815868941219, -1208.143484336257 21.88118684131064, -1210.062747947591 25.80354845218049, -1210.062747947591 
    23.98337133136881, -1208.862071558011 21.52957239679108, -1198.34071655893 0.02728539866782661), (-2716.162211417753 1289.383333619985, -2715.188507426013 1288.626586845606, 
    -2679.804531819042 1276.493392947258, -2656.878369820968 1268.631993947919, -2656.868171422427 1268.627856671546, -2656.858489431966 1268.622623751779, -2656.849441122101 
    1268.616358572038, -1304.9996171221 217.9808445720382, -1304.992694865157 217.9749405341352, -1304.98633785662 217.9684317902316, -1304.980598716821 217.9613722166534, 
    -1304.975524951664 217.9538202492359, -1304.971158559395 217.9458383996198, -1293.893155559397 195.30594139962, -1284.981334459287 177.0930263207704, -1284.262747947591 
    176.5345526681497, -1284.262747947591 177.4446413212285, -1293.174568337072 195.6575548429746, -1304.252571336554 218.2974528419163, -1304.256194213094 218.305798504448, 
    -1304.259043585205 218.3144388977316, -1304.261095867118 218.3233025006374, -1304.262334071004 218.3323159444108, -1304.262747947592 218.3414046199849, -1304.262747947591 
    1268.776226619985, -1304.262266420258 1268.786028334018, -1304.260826475631 1268.795735652187, -1304.258441981164 1268.805255087711, -1304.255135900842 1268.814494963221, 
    -1304.250940074026 1268.823366293668, -1304.245894908821 1268.831783643287, -1304.240048992927 1268.839665948401, -1304.23345862571 1268.846937298104, -1287.59419062571 
    1285.486205298104, -1284.262747947591 1288.817648017135, -1284.262747947591 1289.383333619985, -1284.828433591354 1289.383333619985, -1288.159876269472 1286.051890941866, 
    -1304.799144269473 1269.412622941866, -1304.806415619176 1269.406032574649, -1304.81429792429 1269.400186658755, -1304.82271527391 1269.39514149355, -1304.831586604356 
    1269.390945666734, -1304.840826479867 1269.387639586412, -1304.850345915391 1269.385255091945, -1304.860053233559 1269.383815147318, -1304.869854947592 1269.383333619985, 
    -2656.586443947591 1269.383333619984, -2656.597432924724 1269.383939241966, -2656.608288798534 1269.385748772353, -2656.618880077906 1269.388740293316, -2679.545042077907 
    1277.250140293317, -2714.929017089573 1289.383333619985, -2716.162211417753 1289.383333619985))
    """

work_area = 'POLYGON ((4550 3220, 4550 1170, -2380 1170, -2380 3220, 4550 3220))'


def _shapely_pol_to_nest2d_item(product_pol: Polygon):
    points = []
    holes = []
    product_pol = product_pol.buffer(10).convex_hull

    # First exterior
    polx, poly = product_pol.exterior.coords.xy
    points += [Point(x, y) for x, y in zip(polx, poly)]

    # Then interiors
    for interior in product_pol.interiors:
        polx, poly = interior.coords.xy
        holes.append([Point(x, y) for x, y in zip(polx, poly)])

    # Return item representing the shape of the shapely polygon
    return Item(points, holes)


def _shapely_pol_to_nest2d_box(pol: Polygon):
    x_min, y_min, x_max, y_max = pol.bounds
    return Box(x_max - x_min, y_max - y_min)


# load shapely polygon
products_pol = [wkt.loads(product1_wkt), wkt.loads(product3_wkt), wkt.loads(product2_wkt)]
product_items = [_shapely_pol_to_nest2d_item(pol) for pol in products_pol]

# load work area
work_area_pol = wkt.loads(work_area)
nest_area = _shapely_pol_to_nest2d_box(work_area_pol)

# load placer configuration
pcg = placer_config()
rot_options = 120
pcg.rotations = [Radians(idx/rot_options*2*pi) for idx in range(rot_options)]
pcg.alignment = placer_config.Alignment.BOTTOM_LEFT
pcg.starting_point = placer_config.Alignment.CENTER

# nest the items
pgrp = nest(product_items, nest_area, pcg)
print(pgrp[0][0].transformedShape().contour)
# plot results
sw = SVGWriter()
sw.write_packgroup(pgrp, nest_area)
sw.save()

# item.translation() contains the translation w.r.t it original position of the item
# item.rotation() contains the rotation in radians
# pgrp contains the items in the same order as the input item list(!)
# rotation first, then translate
